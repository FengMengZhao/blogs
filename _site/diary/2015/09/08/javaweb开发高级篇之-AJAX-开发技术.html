<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>麦羞 - javaweb开发高级篇之AJAX技术</title>
  <meta name="author" content="麦羞" />
  <meta name="description" content="The blog of 麦羞" />
  <link rel="canonical" href="/blogs/diary/2015/09/08/javaweb%E5%BC%80%E5%8F%91%E9%AB%98%E7%BA%A7%E7%AF%87%E4%B9%8B-AJAX-%E5%BC%80%E5%8F%91%E6%8A%80%E6%9C%AF.html" />
  <!-- <script type="text/javascript" src="//use.typekit.net/jxo0xyj.js"></script> -->
  <!-- <script type="text/javascript">try{Typekit.load();}catch(e){}</script> -->
  <link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800" rel="stylesheet" type="text/css">
  <link rel="shortcut icon" href="/blogs/assets/images/favicon.png">
  <link rel="alternate" type="application/rss+xml" title="麦羞" href="/blogs/atom.xml" />
  <link rel="stylesheet" href="/blogs/assets/css/all.css">
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.min.css">
</head>
<body>
  <div class="container">
    <div class="four columns sidebar">
      <nav>
  <h1>博客</h1>
  <a href="/">
      <img src="/blogs/assets/images/fmz-logo2.png" id="logo" alt="Blog logo"/>
  </a>
  <h2>@ <a href="/blogs/resume">麦羞</a>.</h2>
  <hr/>
  <ul>
  <p>在这里我分享我的每一步成长 </p>
  <p>
    我是一名在读研究生
  </p>
  <hr/>
  <div>
    <div id="social">
      Follow me:
<div id="stalker">
  
  <a title="FengMengZhao on Github" href="https://github.com/FengMengZhao">
    <i class="fa fa-github-square"></i>
  </a>
  

  
  <a title="fengmengzhao on Twitter" href="https://twitter.com/fengmengzhao">
    <i class="fa fa-twitter-square"></i>
  </a>
  

  
  <a title="麦羞 on Facebook" href="https://facebook.com/100008350779619">
    <i class="fa fa-facebook-square"></i>
  </a>
  

  
  <a title="麦羞 on Google Plus" href="https://plus.google.com/105478354193409781551">
    <i class="fa fa-google-plus-square"></i>
  </a>
  

</div>

    </div>
  </div>
  </ul>
</nav>

    </div>

    <div class="eleven columns content">
        <p class="meta">
  September 08, 2015
  <a href="/">
    <i class="home fa fa-home"></i>
  </a>
</p>

<h1 class="title">javaweb开发高级篇之AJAX技术</h1>

<div id="post">
  <h2 id="目录">目录</h2>

<ul>
  <li>
    <p><a href="#1">1 AJAX技术简介</a></p>
  </li>
  <li>
    <p><a href="#2">2 XMLHttpRequest对象</a></p>
  </li>
  <li>
    <p><a href="#3">3 第一个AJAX程序</a></p>
  </li>
  <li>
    <p><a href="#4">4 异步验证</a></p>
  </li>
  <li>
    <p><a href="#5">5 返回xml数据</a></p>
  </li>
</ul>

<hr />

<hr />

<h2 id="1">1 AJAX技术简介</h2>

<p>  AJAX(Asynchronous JavaScript and XML，异步JavaScript和XML)主要的目的是用于页面的局部刷新
***</p>

<hr />

<h2 id="2">2 XMLHttpRequest对象</h2>

<p>  创建XMLHttpRequest对象-create_ajax.html</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;title&gt;&lt;/title&gt;</span>
		<span class="nt">&lt;script </span><span class="na">language=</span><span class="s">"javaScript"</span><span class="nt">&gt;</span>
			<span class="kd">var</span> <span class="nx">xmlHttp</span> <span class="p">;</span><span class="c1">//AJAX核心对象名称</span>
			<span class="kd">function</span> <span class="nx">creatXMLHttp</span><span class="p">(){</span><span class="c1">//创建XMLHttpRequest核心对象</span>
				<span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="p">){</span><span class="c1">//判断当前使用的浏览器类型</span>
					<span class="nx">xmlHttp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">()</span> <span class="p">;</span><span class="c1">//表示使用的是FireFox内核的浏览器</span>
				<span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="c1">//表示使用的是IE内核的浏览器</span>
					<span class="nx">xmlHttp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">"Microsoft.XMLHTTP"</span><span class="p">)</span> <span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		
	<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<hr />

<hr />

<h2 id="3">3 第一个AJAX程序</h2>

<p>  返回数据页面-content.html</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hello World!!!
</code></pre></div></div>

<p>  使用异步处理-ajax_receive_content.html</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;title&gt;&lt;/title&gt;</span>
		<span class="nt">&lt;script </span><span class="na">language=</span><span class="s">"javaScript"</span><span class="nt">&gt;</span>
			<span class="kd">var</span> <span class="nx">xmlHttp</span> <span class="p">;</span><span class="c1">//AJAX核心对象名称</span>
			<span class="kd">function</span> <span class="nx">creatXMLHttp</span><span class="p">(){</span><span class="c1">//创建XMLHttpRequest核心对象</span>
				<span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="p">){</span><span class="c1">//判断当前使用的浏览器类型</span>
					<span class="nx">xmlHttp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">()</span> <span class="p">;</span><span class="c1">//表示使用的是FireFox内核的浏览器</span>
				<span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="c1">//表示使用的是IE内核的浏览器</span>
					<span class="nx">xmlHttp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">"Microsoft.XMLHTTP"</span><span class="p">)</span> <span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="kd">function</span> <span class="nx">showMsg</span><span class="p">(){</span>
				<span class="nx">creatXMLHttp</span><span class="p">()</span> <span class="p">;</span><span class="c1">//创建一个xmlHttp核心对象</span>
				<span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"POST"</span><span class="p">,</span><span class="s2">"content.htm"</span><span class="p">)</span> <span class="p">;</span><span class="c1">//设置一个请求</span>
				<span class="c1">//设置请求完成之后处理回调函数</span>
				<span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="nx">showMsgCallback</span> <span class="p">;</span>
				<span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span> <span class="p">;</span><span class="c1">//发送请求，不传递任何参数</span>
			<span class="p">}</span>
			<span class="kd">function</span> <span class="nx">showMsgCallback</span><span class="p">(){</span><span class="c1">//定义回调函数</span>
				<span class="k">if</span><span class="p">(</span><span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">readystate</span> <span class="o">=</span> <span class="mi">4</span><span class="p">){</span><span class="c1">//数据返回完毕</span>
					<span class="k">if</span><span class="p">(</span><span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">){</span><span class="c1">//Http 操作正常</span>
						<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">responseText</span> <span class="p">;</span><span class="c1">//接收返回内容</span>
						<span class="c1">//设置要使用的css样式表名称</span>
						<span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"msg"</span><span class="p">).</span><span class="nx">className</span> <span class="o">=</span> <span class="s2">"样式表名称"</span> <span class="p">;</span>
						<span class="c1">//设置Msg标签元素中要显示的内容为AJAX接收的返回值内容</span>
						<span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"msg"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">text</span> <span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">onclick=</span><span class="s">"showMsg()"</span> <span class="na">value=</span><span class="s">"调用AJAX显示内容"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;span</span> <span class="na">id=</span><span class="s">"msg"</span><span class="nt">&gt;&lt;/span&gt;</span>
	<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<hr />

<hr />

<h2 id="4">4 异步验证</h2>

<p>  编写注册表表单-register.html</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;title&gt;&lt;/title&gt;</span>
		<span class="nt">&lt;script </span><span class="na">language=</span><span class="s">"javaScript"</span><span class="nt">&gt;</span>
			<span class="kd">var</span> <span class="nx">xmlHttp</span> <span class="p">;</span>
			<span class="kd">var</span> <span class="nx">flag</span> <span class="p">;</span>
			<span class="kd">function</span> <span class="nx">creatXMLHttp</span><span class="p">(){</span>
				<span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">XMLHttpResponse</span><span class="p">){</span>
					<span class="nx">xmlHttp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMlHttpResponse</span><span class="p">()</span> <span class="p">;</span>
				<span class="p">}</span><span class="k">else</span><span class="p">{</span>
					<span class="nx">xmlHttp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">"Microsoft.XMLHTTP"</span><span class="p">)</span> <span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="kd">function</span> <span class="nx">checkUserid</span><span class="p">(</span><span class="nx">userid</span><span class="p">){</span>
				<span class="nx">creatXMLHttp</span><span class="p">()</span> <span class="p">;</span>
				<span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"POST"</span><span class="p">,</span><span class="s2">"checkServlet?userid="</span><span class="o">+</span><span class="nx">userid</span><span class="p">)</span> <span class="p">;</span>
				<span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="nx">checkUseridCallback</span> <span class="p">;</span>
				<span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span> <span class="p">;</span>
				<span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"msg"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">"正在验证..."</span> <span class="p">;</span>
			<span class="p">}</span>
			<span class="kd">function</span> <span class="nx">checkUseridCallback</span><span class="p">(){</span>
				<span class="k">if</span><span class="p">(</span><span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">==</span> <span class="mi">4</span><span class="p">){</span>
					<span class="k">if</span><span class="p">(</span><span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">){</span>
						<span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">responseText</span> <span class="p">;</span>
						<span class="k">if</span><span class="p">(</span><span class="nx">text</span> <span class="o">==</span> <span class="s2">"true"</span><span class="p">){</span>
							<span class="nx">flag</span> <span class="o">=</span> <span class="kc">false</span> <span class="p">;</span>
							<span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"msg"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">"用户ID重复，无法使用！"</span> <span class="p">;</span>
						<span class="p">}</span><span class="k">else</span><span class="p">{</span>
							<span class="nx">flag</span> <span class="o">=</span> <span class="kc">true</span> <span class="p">;</span>
							<span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"msg"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">"此用户ID可以注册！"</span> <span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="kd">function</span> <span class="nx">checkForm</span><span class="p">(){</span>
				<span class="k">return</span> <span class="nx">flag</span> <span class="p">;</span>
			<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
		<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"register.jsp"</span> <span class="na">method=</span><span class="s">"post"</span> <span class="na">onsubmit=</span><span class="s">"return checkForm()"</span><span class="nt">&gt;</span>
			用户ID：<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"userid"</span> <span class="na">onblur=</span><span class="s">"checkUserid(this.value)"</span><span class="nt">&gt;&lt;span</span> <span class="na">id=</span><span class="s">"msg"</span><span class="nt">&gt;&lt;/span&gt;&lt;br&gt;</span>
			姓<span class="ni">&amp;nbsp;</span>名：<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"uname"</span><span class="nt">&gt;&lt;br&gt;</span>
			密<span class="ni">&amp;nbsp;</span>码：<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"password"</span> <span class="na">name=</span><span class="s">"upass"</span><span class="nt">&gt;&lt;br&gt;</span>
			<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"注册"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"reset"</span> <span class="na">value=</span><span class="s">"重置"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;/form&gt;</span>
	<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>  验证用户名是否存在Servlet程序-CheckServlet.java</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">org</span><span class="p">.</span><span class="n">fmz</span><span class="p">.</span><span class="n">ajaxdemo</span> <span class="p">;</span>

<span class="n">import</span> <span class="n">java</span><span class="p">.</span><span class="n">io</span><span class="p">.*</span> <span class="p">;</span>
<span class="n">import</span> <span class="n">java</span><span class="p">.</span><span class="n">sql</span><span class="p">.*</span> <span class="p">;</span>
<span class="n">import</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.*</span> <span class="p">;</span>
<span class="n">import</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.</span><span class="n">http</span><span class="p">.*</span> <span class="p">;</span>

<span class="k">public</span> <span class="n">class</span> <span class="n">CheckServlet</span> <span class="n">extends</span> <span class="n">HttpServlet</span><span class="p">{</span>
	<span class="k">public</span> <span class="n">static</span> <span class="n">final</span> <span class="k">String</span> <span class="n">DBDRIVER</span> <span class="p">=</span> <span class="s2">"org.gjt.mm.mysql.Driver"</span> <span class="p">;</span>
	<span class="k">public</span> <span class="n">static</span> <span class="n">final</span> <span class="k">String</span> <span class="n">DBURL</span> <span class="p">=</span> <span class="s2">"jdbc:mysql://localhost:3306/mldn"</span> <span class="p">;</span>
	<span class="k">public</span> <span class="n">static</span> <span class="n">final</span> <span class="k">String</span> <span class="n">DBUSER</span> <span class="p">=</span> <span class="s2">"root"</span> <span class="p">;</span>
	<span class="k">public</span> <span class="n">static</span> <span class="n">final</span> <span class="k">String</span> <span class="n">DBPASS</span> <span class="p">=</span> <span class="s2">"mysqladmin"</span> <span class="p">;</span>
	<span class="k">public</span> <span class="n">void</span> <span class="n">doPost</span><span class="p">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="p">,</span><span class="n">HttpServletResponse</span> <span class="n">response</span><span class="p">)</span><span class="n">throws</span> <span class="n">ServletException</span><span class="p">,</span><span class="n">IOException</span><span class="p">{</span>
		<span class="n">request</span><span class="p">.</span><span class="n">setCharacterEncoding</span><span class="p">(</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">response</span><span class="p">.</span><span class="n">setContentType</span><span class="p">(</span><span class="s2">"text/html"</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">Connection</span> <span class="n">conn</span> <span class="p">=</span> <span class="n">null</span> <span class="p">;</span>
		<span class="n">PreparedStatement</span> <span class="n">pstmt</span> <span class="p">=</span> <span class="n">null</span> <span class="p">;</span>
		<span class="n">ResultSet</span> <span class="n">rs</span> <span class="p">=</span> <span class="n">null</span> <span class="p">;</span>
		<span class="n">PrintWriter</span> <span class="n">out</span> <span class="p">=</span> <span class="n">response</span><span class="p">.</span><span class="n">getWriter</span><span class="p">()</span> <span class="p">;</span>
		<span class="k">String</span> <span class="n">userid</span> <span class="p">=</span> <span class="n">request</span><span class="p">.</span><span class="n">getParameter</span><span class="p">(</span><span class="s2">"userid"</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">try</span><span class="p">{</span>
			<span class="n">Class</span><span class="p">.</span><span class="n">forName</span><span class="p">(</span><span class="n">DBDRIVER</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">conn</span> <span class="p">=</span> <span class="n">DriverManager</span><span class="p">.</span><span class="n">getConnection</span><span class="p">(</span><span class="n">DBURL</span><span class="p">,</span><span class="n">DBUSER</span><span class="p">,</span><span class="n">DBPASS</span><span class="p">)</span> <span class="p">;</span>
			<span class="k">String</span> <span class="n">sql</span> <span class="p">=</span> <span class="s2">"SELECT COUNT(userid) FROM user WHERE userid=?"</span> <span class="p">;</span>
			<span class="n">pstmt</span> <span class="p">=</span> <span class="n">conn</span><span class="p">.</span><span class="n">prepareStatement</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">pstmt</span><span class="p">.</span><span class="n">setString</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">userid</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">rs</span> <span class="p">=</span> <span class="n">pstmt</span><span class="p">.</span><span class="n">executeQuery</span><span class="p">()</span> <span class="p">;</span>
			<span class="k">if</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="k">next</span><span class="p">()){</span>
				<span class="k">if</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="n">getInt</span><span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">){</span>
					<span class="n">out</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s2">"true"</span><span class="p">)</span> <span class="p">;</span>
				<span class="p">}</span><span class="k">else</span><span class="p">{</span>
					<span class="n">out</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s2">"false"</span><span class="p">)</span> <span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="n">out</span><span class="p">.</span><span class="n">close</span><span class="p">()</span> <span class="p">;</span>
		<span class="p">}</span><span class="n">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">){</span>
			<span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">()</span> <span class="p">;</span>
		<span class="p">}</span><span class="n">finally</span><span class="p">{</span>
			<span class="n">try</span><span class="p">{</span>
				<span class="n">rs</span><span class="p">.</span><span class="n">close</span><span class="p">()</span> <span class="p">;</span>
				<span class="n">pstmt</span><span class="p">.</span><span class="n">close</span><span class="p">()</span> <span class="p">;</span>
				<span class="n">conn</span><span class="p">.</span><span class="n">close</span><span class="p">()</span> <span class="p">;</span>
			<span class="p">}</span><span class="n">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">){</span>
				<span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">()</span> <span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		
	<span class="p">}</span>
	<span class="k">public</span> <span class="n">void</span> <span class="n">doGet</span><span class="p">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="p">,</span><span class="n">HttpServletResponse</span> <span class="n">response</span><span class="p">)</span><span class="n">throws</span> <span class="n">ServletException</span><span class="p">,</span><span class="n">IOException</span><span class="p">{</span>
		<span class="n">this</span><span class="p">.</span><span class="n">doPost</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="n">response</span><span class="p">)</span> <span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span> <span class="p">***</span>
</code></pre></div></div>

<hr />

<h2 id="5">5 返回xml数据</h2>

<p>  xml文件-allarea.xml</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;allarea&gt;</span>
	<span class="nt">&lt;area&gt;</span>
		<span class="nt">&lt;id&gt;</span>1<span class="nt">&lt;/id&gt;</span>
		<span class="nt">&lt;title&gt;</span>北京<span class="nt">&lt;/title&gt;</span>
	<span class="nt">&lt;/area&gt;</span>
	<span class="nt">&lt;area&gt;</span>
		<span class="nt">&lt;id&gt;</span>2<span class="nt">&lt;/id&gt;</span>
		<span class="nt">&lt;title&gt;</span>上海<span class="nt">&lt;/title&gt;</span>
	<span class="nt">&lt;/area&gt;</span>
	<span class="nt">&lt;area&gt;</span>
		<span class="nt">&lt;id&gt;</span>3<span class="nt">&lt;/id&gt;</span>
		<span class="nt">&lt;title&gt;</span>广州<span class="nt">&lt;/title&gt;</span>
	<span class="nt">&lt;/area&gt;</span>
<span class="nt">&lt;/allarea&gt;</span>
</code></pre></div></div>

<p>  使用AJAX解析，并生成下拉列表框-ajax_select.html</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;title&gt;&lt;/title&gt;</span>
		<span class="nt">&lt;script </span><span class="na">language=</span><span class="s">"javaScript"</span><span class="nt">&gt;</span>
			<span class="kd">var</span> <span class="nx">xmlHttp</span> <span class="p">;</span>
			<span class="kd">function</span> <span class="nx">createXMLHttp</span><span class="p">(){</span>
				<span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="p">){</span>
					<span class="nx">xmlHttp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">()</span> <span class="p">;</span>
				<span class="p">}</span><span class="k">else</span><span class="p">{</span>
					<span class="nx">xmlHttp</span> <span class="o">=</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">"Microsoft.XMLHTTP"</span><span class="p">)</span> <span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="kd">function</span> <span class="nx">getCity</span><span class="p">(){</span>
				<span class="nx">createXMLHttp</span><span class="p">()</span> <span class="p">;</span>
				<span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"POST"</span><span class="p">,</span><span class="s2">"allarea.xml"</span><span class="p">)</span> <span class="p">;</span>
				<span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="nx">getCityCallback</span> <span class="p">;</span>
				<span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span> <span class="p">;</span>
			<span class="p">}</span>
			<span class="kd">function</span> <span class="nx">getCityCallback</span><span class="p">(){</span>
				<span class="k">if</span><span class="p">(</span><span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">==</span> <span class="mi">4</span><span class="p">){</span>
					<span class="k">if</span><span class="p">(</span><span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">){</span>
						<span class="kd">var</span> <span class="nx">allarea</span> <span class="o">=</span> <span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">responseXML</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">"allarea"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">childNodes</span> <span class="p">;</span><span class="c1">//取得下拉列表框city对象</span>
						<span class="kd">var</span> <span class="nx">select</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"city"</span><span class="p">)</span> <span class="p">;</span>
						<span class="nx">select</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">;</span>
						<span class="nx">select</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">selected</span> <span class="o">=</span> <span class="kc">true</span> <span class="p">;</span>
						<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">allarea</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>
							<span class="kd">var</span> <span class="nx">area</span> <span class="o">=</span> <span class="nx">allarea</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">;</span>
							<span class="kd">var</span> <span class="nx">option</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">"option"</span><span class="p">)</span> <span class="p">;</span><span class="c1">//创建option元素</span>
							<span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">area</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">"id"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">firstChild</span><span class="p">.</span><span class="nx">nodeValue</span> <span class="p">;</span><span class="c1">//取得每一个</span><span class="o">&lt;</span><span class="nx">area</span><span class="o">&gt;</span><span class="err">中的</span><span class="nx">id</span><span class="err">元素</span>
							<span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">area</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">"title"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">firstChild</span><span class="p">.</span><span class="nx">nodeValue</span> <span class="p">;</span>
							<span class="nx">option</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">"value"</span><span class="p">,</span><span class="nx">id</span><span class="p">)</span> <span class="p">;</span><span class="c1">//在option元素中设置显示内容</span>
							<span class="nx">option</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="nx">title</span><span class="p">))</span> <span class="p">;</span>
							<span class="nx">select</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">option</span><span class="p">)</span> <span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body</span> <span class="na">onLoad=</span><span class="s">"getCity()"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">""</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
			请选择喜欢的城市：
			<span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"city"</span><span class="nt">&gt;</span>
				<span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"0"</span><span class="nt">&gt;</span>=====请选择城市=====<span class="nt">&lt;/option&gt;</span>
			<span class="nt">&lt;/select&gt;</span>
		<span class="nt">&lt;/form&gt;</span>
	<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<blockquote>
  <p>解析文件没有成功！！！</p>
</blockquote>

<p>  利用dom解析，Servlet程序-CityServlet.java</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">org</span><span class="p">.</span><span class="n">fmz</span><span class="p">.</span><span class="n">ajaxdemo</span> <span class="p">;</span>

<span class="n">import</span> <span class="n">java</span><span class="p">.</span><span class="n">io</span><span class="p">.*</span> <span class="p">;</span>
<span class="n">import</span> <span class="n">org</span><span class="p">.</span><span class="n">w3c</span><span class="p">.</span><span class="n">dom</span><span class="p">.*</span> <span class="p">;</span>
<span class="n">import</span> <span class="n">javax</span><span class="p">.</span><span class="n">xml</span><span class="p">.</span><span class="n">transform</span><span class="p">.*</span> <span class="p">;</span>
<span class="n">import</span> <span class="n">javax</span><span class="p">.</span><span class="n">xml</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">dom</span><span class="p">.*</span> <span class="p">;</span>
<span class="n">import</span> <span class="n">javax</span><span class="p">.</span><span class="n">xml</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">stream</span><span class="p">.*</span> <span class="p">;</span>
<span class="n">import</span> <span class="n">javax</span><span class="p">.</span><span class="n">xml</span><span class="p">.</span><span class="n">parsers</span><span class="p">.*</span> <span class="p">;</span>
<span class="n">import</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.*</span> <span class="p">;</span>
<span class="n">import</span> <span class="n">javax</span><span class="p">.</span><span class="n">servlet</span><span class="p">.</span><span class="n">http</span><span class="p">.*</span> <span class="p">;</span>

<span class="k">public</span> <span class="n">class</span> <span class="n">CityServlet</span> <span class="n">extends</span> <span class="n">HttpServlet</span><span class="p">{</span>
	<span class="k">public</span> <span class="n">void</span> <span class="n">doGet</span><span class="p">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="p">,</span><span class="n">HttpServletResponse</span> <span class="n">response</span><span class="p">)</span><span class="n">throws</span> <span class="n">ServletException</span><span class="p">,</span><span class="n">IOException</span><span class="p">{</span>
		<span class="n">this</span><span class="p">.</span><span class="n">doPost</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="n">response</span><span class="p">)</span> <span class="p">;</span>
	<span class="p">}</span>
	<span class="k">public</span> <span class="n">void</span> <span class="n">doPost</span><span class="p">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="p">,</span><span class="n">HttpServletResponse</span> <span class="n">response</span><span class="p">)</span><span class="n">throws</span> <span class="n">ServletException</span><span class="p">,</span><span class="n">IOException</span><span class="p">{</span>
		<span class="n">response</span><span class="p">.</span><span class="n">setContentType</span><span class="p">(</span><span class="s2">"text/xml;charset=utf-8"</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">PrintWriter</span> <span class="n">out</span> <span class="p">=</span> <span class="n">response</span><span class="p">.</span><span class="n">getWriter</span><span class="p">()</span> <span class="p">;</span>
		<span class="n">ByteArrayOutputStream</span> <span class="n">bos</span> <span class="p">=</span> <span class="n">new</span> <span class="n">ByteArrayOutputStream</span><span class="p">()</span> <span class="p">;</span>
		<span class="n">try</span><span class="p">{</span>
		<span class="n">DocumentBuilderFactory</span> <span class="n">db_factory</span> <span class="p">=</span> <span class="n">DocumentBuilderFactory</span><span class="p">.</span><span class="n">newInstance</span><span class="p">()</span> <span class="p">;</span>
		<span class="n">DocumentBuilder</span> <span class="n">builder</span> <span class="p">=</span> <span class="n">db_factory</span><span class="p">.</span><span class="n">newDocumentBuilder</span><span class="p">()</span> <span class="p">;</span>
		<span class="n">Document</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">builder</span><span class="p">.</span><span class="n">newDocument</span><span class="p">()</span> <span class="p">;</span>
		<span class="k">String</span><span class="p">[]</span> <span class="n">data</span> <span class="p">=</span> <span class="p">{</span><span class="s2">"北京"</span><span class="p">,</span><span class="s2">"上海"</span><span class="p">,</span><span class="s2">"广州"</span><span class="p">,</span><span class="s2">"天津"</span><span class="p">,</span><span class="s2">"香港"</span><span class="p">}</span> <span class="p">;</span>
		<span class="n">Element</span> <span class="n">allarea</span> <span class="p">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">createElement</span><span class="p">(</span><span class="s2">"allarea"</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">for</span><span class="p">(</span><span class="n">int</span> <span class="n">x</span><span class="p">=</span><span class="m">0</span><span class="p">;</span><span class="n">x</span><span class="p">&lt;</span><span class="n">data</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="n">x</span><span class="p">++){</span>
			<span class="n">Element</span> <span class="n">area</span> <span class="p">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">createElement</span><span class="p">(</span><span class="s2">"area"</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">Element</span> <span class="n">id</span> <span class="p">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">createElement</span><span class="p">(</span><span class="s2">"id"</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">Element</span> <span class="n">title</span> <span class="p">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">createElement</span><span class="p">(</span><span class="s2">"title"</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">id</span><span class="p">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">doc</span><span class="p">.</span><span class="n">createTextNode</span><span class="p">(</span><span class="s2">""</span> <span class="p">+</span> <span class="p">(</span><span class="n">x</span><span class="p">+</span><span class="m">1</span><span class="p">)))</span> <span class="p">;</span>
			<span class="n">title</span><span class="p">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">doc</span><span class="p">.</span><span class="n">createTextNode</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]))</span> <span class="p">;</span>
			<span class="n">area</span><span class="p">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">id</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">area</span><span class="p">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">title</span><span class="p">)</span> <span class="p">;</span>
			<span class="n">allarea</span><span class="p">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">area</span><span class="p">)</span> <span class="p">;</span>
		<span class="p">}</span>
		<span class="n">doc</span><span class="p">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">allarea</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">TransformerFactory</span> <span class="n">tf_factory</span> <span class="p">=</span> <span class="n">TransformerFactory</span><span class="p">.</span><span class="n">newInstance</span><span class="p">()</span> <span class="p">;</span>
		<span class="n">Transformer</span> <span class="n">t</span> <span class="p">=</span> <span class="n">tf_factory</span><span class="p">.</span><span class="n">newTransformer</span><span class="p">()</span> <span class="p">;</span>
		<span class="n">t</span><span class="p">.</span><span class="n">setOutputProperty</span><span class="p">(</span><span class="n">OutputKeys</span><span class="p">.</span><span class="n">ENCODING</span><span class="p">,</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">DOMSource</span> <span class="n">source</span> <span class="p">=</span> <span class="n">new</span> <span class="n">DOMSource</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">StreamResult</span> <span class="n">result</span> <span class="p">=</span> <span class="n">new</span> <span class="n">StreamResult</span><span class="p">(</span><span class="n">bos</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">t</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">result</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">bos</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">out</span><span class="p">.</span><span class="n">close</span><span class="p">()</span> <span class="p">;</span>
		<span class="p">}</span><span class="n">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">){</span>
			<span class="n">e</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">()</span> <span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>  调用Servlet程序，生成下拉列表框-ajax_select_servlet.html</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;title&gt;&lt;/title&gt;</span>
		<span class="nt">&lt;script </span><span class="na">language=</span><span class="s">"JavaScript"</span><span class="nt">&gt;</span>
			<span class="kd">var</span> <span class="nx">xmlHttp</span> <span class="p">;</span>
			<span class="kd">function</span> <span class="nx">createXMLHttp</span><span class="p">(){</span>
				<span class="k">if</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="p">){</span>
					<span class="nx">xmlHttp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">()</span> <span class="p">;</span>
				<span class="p">}</span><span class="k">else</span><span class="p">{</span>
					<span class="nx">xmlHttp</span> <span class="o">=</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">"Microsoft.XMLHTTP"</span><span class="p">)</span> <span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="kd">function</span> <span class="nx">getCity</span><span class="p">(){</span>
				<span class="nx">createXMLHttp</span><span class="p">()</span> <span class="p">;</span>
				<span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"POST"</span><span class="p">,</span><span class="s2">"cityServlet"</span><span class="p">)</span> <span class="p">;</span>
				<span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="nx">getCityCallback</span> <span class="p">;</span>
				<span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span> <span class="p">;</span>
			<span class="p">}</span>
			<span class="kd">function</span> <span class="nx">getCityCallback</span><span class="p">(){</span>
				<span class="k">if</span><span class="p">(</span><span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">==</span> <span class="mi">4</span><span class="p">){</span>
					<span class="k">if</span><span class="p">(</span><span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">){</span>
						<span class="kd">var</span> <span class="nx">allarea</span> <span class="o">=</span> <span class="nx">xmlHttp</span><span class="p">.</span><span class="nx">responseXML</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">"allarea"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">childNodes</span> <span class="p">;</span><span class="c1">//取得下拉列表框city对象</span>
						<span class="kd">var</span> <span class="nx">select</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"city"</span><span class="p">)</span> <span class="p">;</span>
						<span class="nx">select</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">;</span>
						<span class="nx">select</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">selected</span> <span class="o">=</span> <span class="kc">true</span> <span class="p">;</span>
						<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">allarea</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>
							<span class="kd">var</span> <span class="nx">area</span> <span class="o">=</span> <span class="nx">allarea</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">;</span>
							<span class="kd">var</span> <span class="nx">option</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">"option"</span><span class="p">)</span> <span class="p">;</span><span class="c1">//创建option元素</span>
							<span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">area</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">"id"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">firstChild</span><span class="p">.</span><span class="nx">nodeValue</span> <span class="p">;</span><span class="c1">//取得每一个</span><span class="o">&lt;</span><span class="nx">area</span><span class="o">&gt;</span><span class="err">中的</span><span class="nx">id</span><span class="err">元素</span>
							<span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">area</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">"title"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">firstChild</span><span class="p">.</span><span class="nx">nodeValue</span> <span class="p">;</span>
							<span class="nx">option</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">"value"</span><span class="p">,</span><span class="nx">id</span><span class="p">)</span> <span class="p">;</span><span class="c1">//在option元素中设置显示内容</span>
							<span class="nx">option</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="nx">title</span><span class="p">))</span> <span class="p">;</span>
							<span class="nx">select</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">option</span><span class="p">)</span> <span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body</span> <span class="na">onLoad=</span><span class="s">"getCity()"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">""</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
			请选择喜欢的城市：
			<span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"city"</span><span class="nt">&gt;</span>
				<span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"0"</span><span class="nt">&gt;</span>=====请选择城市=====<span class="nt">&lt;/option&gt;</span>
			<span class="nt">&lt;/select&gt;</span>
		<span class="nt">&lt;/form&gt;</span>
	<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<blockquote>
  <p>解析文件没有成功！！！</p>
</blockquote>

<hr />

<hr />

</div>

      <div class="footer">
        <div class="disclaimer">
  
  <p>
    The postings on this site are my own and I am only responsible for myself
  </p>
  

  <p>
    © 麦羞, 2017 &mdash; built with Jekyll based on Github
  </p>
</div>

      </div>
    </div>
  </div>


<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34087103-1']);
  
  _gaq.push(['_setDomainName', 'lenage.com']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


<script type="text/javascript" src="/blogs/assets/scripts/MathJax-2.0-min.js"></script>
<script type="text/javascript" src="/blogs/assets/scripts/jquery-1.11.3.min.js"></script>
<script>
  $(function(){
    var $category = $('ul#java-posts li:gt(8):not(:last)');
    $category.hide();
    var $toggleBtn=$('div.java-showmore > a') ;
    $toggleBtn.click(function(){
      if($category.is(":visible")){
            $category.hide() ;
            $('div.java-showmore a span')
              .text("More...") ;
          }else{
            $category.show() ;
            $('div.java-showmore a span')
            .text("Less") ;
          }
          return false ;
    })
  })

  $(function(){
    var $category = $('ul#diary-posts li:gt(8):not(:last)');
    $category.hide();
    var $toggleBtn=$('div.diary-showmore > a') ;
    $toggleBtn.click(function(){
      if($category.is(":visible")){
            $category.hide() ;
            $('div.diary-showmore a span')
              .text("More...") ;
          }else{
            $category.show() ;
            $('div.diary-showmore a span')
            .text("Less") ;
          }
          return false ;
    })
  })
</script>

</body>
</html>
